<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>My Valentine's Love Letter</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Caveat:wght@400..700&family=Quicksand:wght@300;400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style-pages.css"> 
    <link rel="stylesheet" href="style-musicPlayer.css">
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&display=swap" rel="stylesheet">
</head>
<body>
    <!-- Chibi Characters Container -->
    <div id="chibi-container"></div>
    
    <header>
        <h1><i class="fas fa-heart"></i> My Valentine <i class="fas fa-heart"></i></h1>
        <p class="subtitle">A digital scrapbook of love and memories</p>
    </header>
    
    <!-- Page Navigation -->
    <div class="page-nav">
        <button class="nav-btn active" data-page="1">1</button>
        <button class="nav-btn" data-page="2">2</button>
        <button class="nav-btn" data-page="3">3</button>
        <button class="nav-btn" data-page="4">4</button>
        <button class="nav-btn" data-page="5">5</button>
        <button class="nav-btn" data-page="6">6</button>
    </div>
    
    <!-- Scrapbook Pages Container -->
    <div class="scrapbook-container">
        <!-- Page 1: Cover -->
        <div class="page active" id="page1">
            <div class="tape" style="top: 20px; left: 50px;"></div>
            <div class="heart-sticker" style="top: 50px; right: 15px;"></div>
            
            <div class="cover-page">
                <div class="cover-title">
                    HAPPY VALENTINE'S DAY<br>
                    <span style="font-size: 2.5rem; color: #8D6E63;">MY LOVE</span>
                </div>
                
                <div class="cover-subtitle">
                    A collection of memories just for you
                </div>
                
                <div class="cover-image">
                    <img src="https://images.unsplash.com/photo-1518568814500-bf0f8d125f46?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=600&q=80" alt="Valentine's Day">
                </div>
                
                <button class="next-btn" id="nextBtn">
                    Open My Love Letter <i class="fas fa-heart"></i>
                </button>
            </div>
        </div>
        
        <!-- Page 2: Love Letter -->
        <div class="page" id="page2">
            <div class="tape" style="top: 150px; right: 50px;"></div>
            
            <div class="page-title">
                <h2><i class="fas fa-envelope"></i> A Love Letter Just For You</h2>
            </div>
            
            <div class="love-letter">
                <div class="letter-content">
                    <p>I‚Äôve been sitting here thinking about us, and I just had to put these feelings into words.
                        You are more than just my partner; you are my home.</p>
                    
                    <p>Beyond how I feel for you, I want to tell you how much I appreciate the changes you‚Äôve made within yourself.
                        I see the work you are putting in, not just for "us" or for me, but to better yourself as an individual. 
                        I love that you are doing the things needed so that you can finally come to me, 
                        but please know I‚Äôm even happier that this improvement is for you and your future.
                        I want you to learn on your own and feel truly accomplished. I want to hear every detail about it 
                        because I‚Äôm here to support you through it all‚Äîin your toughest moments and in your most victorious ones.</p>
                    
                    <p>Even though we are starting this chapter of long distance, my heart stays with you. 
                        I miss you more as every day goes by, and I am constantly praying for the day we are finally back in each other's arms 
                        and I can lay in your warmth again.
                        I want us to grow old together and live out our lives as one. 
                        I want you to see the things I‚Äôve seen and experience. 
                        I want us to explore this world together‚Äîin this life and the next.</p>
                    
                    <p>I know I don‚Äôt say it enough, but I love and appreciate every little thing you do. 
                        Your existence alone is more than enough for me. 
                        I thank God every day that I found a gem, a true diamond in this world.</p>
                    
                    <p>I love you, and I can‚Äôt wait to experience the rest of my life with you!!</p>
                    <p>Me & you... forever.</p>
                    
                    <div class="signature">
                        With all my heart,<br>
                        Always yours
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Page 3: Photos & Memories -->
        <div class="page" id="page3">
            
            <div class="page-title">
                <h2><i class="fas fa-images"></i> Our Special Memories</h2>
            </div>
            
            <div class="photos-page">
                <div class="media-grid">
                    <!-- Photo 1 -->
                    <div class="media-item">
                        <img src="Images\first-out.jpeg" alt="First outing together">
                        <div class="media-caption">Night Cafe Meet!!</div>
                    </div>
                    
                    <!-- Photo 2 -->
                    <div class="media-item">
                        <img src="Images\random.jpeg" alt="Laughing together">
                        <div class="media-caption">That time we couldn't stop laughing</div>
                    </div>
                    
                    <!-- Video 1 -->
                    <div class="media-item">
                        <video controls poster="Images\video.mp4" type="video/mp4">
                            Your browser does not support the video tag.
                        </video>
                        <div class="media-caption">Moments in the day!!</div>
                    </div>
                    
                    <!-- Photo 4 -->
                    <div class="media-item">
                        <img src="Images/krauta.jpeg" alt="Celebration">
                        <div class="media-caption">Celebrating together</div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Page 4: Song -->
        <div class="page" id="page4">
            <!-- floating hearts background -->
            <div class="heart-bg">
                <i class="fas fa-heart" style="top: 10%; left: 2%; animation-delay: 0s;"></i>
                <i class="fas fa-heart" style="top: 70%; left: 90%; font-size: 32px; animation-delay: 2s;"></i>
                <i class="fas fa-heart" style="top: 40%; left: 20%; font-size: 20px; animation-delay: 1s;"></i>
                <i class="fas fa-heart" style="top: 80%; left: 15%; font-size: 28px; animation-delay: 0.5s;"></i>
                <i class="fas fa-heart" style="top: 20%; left: 85%; font-size: 18px; animation-delay: 3s;"></i>
                <i class="fas fa-heart" style="top: 55%; left: 45%; font-size: 40px; animation-delay: 0.8s;"></i>
                <i class="fas fa-heart" style="top: 88%; left: 70%; font-size: 24px; animation-delay: 1.8s;"></i>
            </div>

            <!-- main player card üíå -->
            <div class="player-card">
                <!-- extra decoration -->
                <div class="candy-stripe"></div>
                <div class="candy-stripe right"></div>

                <!-- header :3 -->
                <div class="player-header">
                <div class="bear-avatar">
                    <i class="fas fa-bear"></i> <!-- cute bear icon (fas fa-bear exists in pro? we use fa-bear from FontAwesome? using alternate) -->
                    <i class="fas fa-gift" style="display: none;"></i> <!-- fallback, but we use fas fa-bear? I'll use fa-heart-bear? I'll use teddy bear: fa-robot? no! -->
                    <i class="fas fa-heart" style="font-size: 42px; color: #6b4e4e; display: none;"></i>
                    <!-- better: use a cat/ bear mix: actual bear exists in FA6 free as 'fa-bear'? yes, since 6.0? use solid bear -->
                    <i class="fas fa-bear" style="font-size: 40px; color: #5d3a3a;"></i>
                </div>
                <div class="valentine-text">
                    <h1>‚ù§Ô∏è  valen~tunes</h1>
                    <p><i class="fas fa-candy-cane"></i> sweetheart session</p>
                </div>
                </div>

                <!-- disc area with rotating love heart (spinning when playing) -->
                <div class="album-area">
                <div class="vinyl-wrapper">
                    <div class="vinyl" id="vinylDisc">
                    <div class="heart-center" id="heartCenter">
                        <i class="fas fa-heart" id="heartIcon"></i>
                    </div>
                    </div>
                </div>
                <div class="song-info">
                    <span class="song-title" id="currentSongTitle">Love Note</span>
                    <span class="artist-name" id="currentSongArtist">be my valentine</span>
                </div>
                </div>

                <!-- progress bar with time -->
                <div class="progress-section">
                <div class="time-row">
                    <span id="currentTime">0:00</span>
                    <span id="durationTime">3:21</span>
                </div>
                <div class="progress-bar-bg" id="progressBarBg">
                    <div class="progress-fill" id="progressFill"></div>
                </div>
                </div>

                <!-- controller buttons -->
                <div class="controls">
                <button class="ctrl-btn" id="prevBtn"><i class="fas fa-backward-step"></i></button>
                <button class="ctrl-btn play-pause" id="playPauseBtn"><i class="fas fa-play" id="playPauseIcon"></i></button>
                <button class="ctrl-btn" id="nextBtn"><i class="fas fa-forward-step"></i></button>
                </div>

                <!-- valentine playlist ~ -->
                <div class="playlist">
                <h3><i class="fas fa-list-music"></i> xoxo playlist</h3>
                <ul class="song-list" id="playlistContainer">
                    <!-- js filled -->
                </ul>
                </div>
                <div class="tiny-heart">
                <i class="fas fa-heart"></i> for you <i class="fas fa-heart"></i>
                </div>
            </div>

            <script>
                (function(){
                "use strict";

                // cute valentine's day playlist üíï
                const playlist = [
                    {
                    title: "Love Note",
                    artist: "cupid & bear",
                    file: "Songs/The Neighbourhood - Sweater Weather (Official Video) - TheNeighbourhoodVEVO.mp3", // placeholder
                    duration: 321
                    },
                    {
                    title: "Strawberry Kisses",
                    artist: "sweetheart choir",
                    file: "Songs/Finding Her (Jana Mere Sawalon Ka Manzar Tu)  Kushagra  Vanshika  Bharath  Karan Maini UR Debut - UR DEBUT.mp3",
                    duration: 285
                    },
                    {
                    title: "Candy Heart",
                    artist: "conversation hearts",
                    file: "Songs/Olly Alexander (Years & Years) - Breathe (Lyric Video) - YearsAndYearsVEVO.mp3",
                    duration: 308
                    }
                ];

                // ---------- DOM elements ----------
                const audio = new Audio();
                let isPlaying = false;
                let currentSongIndex = 0;

                const playPauseBtn = document.getElementById('playPauseBtn');
                const playPauseIcon = document.getElementById('playPauseIcon');
                const prevBtn = document.getElementById('prevBtn');
                const nextBtn = document.getElementById('nextBtn');
                const progressFill = document.getElementById('progressFill');
                const progressBarBg = document.getElementById('progressBarBg');
                const currentTimeEl = document.getElementById('currentTime');
                const durationTimeEl = document.getElementById('durationTime');
                const songTitleEl = document.getElementById('currentSongTitle');
                const artistEl = document.getElementById('currentSongArtist');
                const vinylDisc = document.getElementById('vinylDisc');
                const playlistContainer = document.getElementById('playlistContainer');

                // ---------- helper ----------
                function formatTime(seconds) {
                    if (isNaN(seconds) || seconds < 0) seconds = 0;
                    const mins = Math.floor(seconds / 60);
                    const secs = Math.floor(seconds % 60);
                    return `${mins}:${secs < 10 ? '0' : ''}${secs}`;
                }

                // load song data
                function loadSong(index) {
                    const song = playlist[index];
                    if (!song) return;
                    songTitleEl.textContent = song.title;
                    artistEl.textContent = `üéÄ ${song.artist}`;
                    audio.src = song.file;
                    durationTimeEl.textContent = formatTime(song.duration);
                    // reset progress
                    progressFill.style.width = '0%';
                    currentTimeEl.textContent = '0:00';
                    // update active item in playlist
                    updateActivePlaylist(index);
                }

                // update active playlist style
                function updateActivePlaylist(activeIndex) {
                    const items = document.querySelectorAll('.song-item');
                    items.forEach((item, idx) => {
                    if (idx === activeIndex) {
                        item.classList.add('active');
                    } else {
                        item.classList.remove('active');
                    }
                    });
                }

                // play song
                function playSong() {
                    audio.play()
                    .then(() => {
                        isPlaying = true;
                        playPauseIcon.className = 'fas fa-pause';
                        vinylDisc.classList.add('rotating');
                    })
                    .catch(err => {
                        console.warn("playback failed - Valentine demo (autoplay policy)");
                        isPlaying = false;
                        playPauseIcon.className = 'fas fa-play';
                        vinylDisc.classList.remove('rotating');
                    });
                }

                // pause song
                function pauseSong() {
                    audio.pause();
                    isPlaying = false;
                    playPauseIcon.className = 'fas fa-play';
                    vinylDisc.classList.remove('rotating');
                }

                // toggle play/pause
                function togglePlayPause() {
                    if (isPlaying) {
                    pauseSong();
                    } else {
                    playSong();
                    }
                }

                // go to previous song
                function prevSong() {
                    currentSongIndex = (currentSongIndex - 1 + playlist.length) % playlist.length;
                    loadSong(currentSongIndex);
                    if (isPlaying) {
                    playSong(); // will restart
                    } else {
                    // if not playing, just load
                    }
                }

                // go to next song
                function nextSong() {
                    currentSongIndex = (currentSongIndex + 1) % playlist.length;
                    loadSong(currentSongIndex);
                    if (isPlaying) {
                    playSong();
                    }
                }

                // update progress bar & time
                function updateProgress() {
                    if (audio.duration && !isNaN(audio.duration)) {
                    const percent = (audio.currentTime / audio.duration) * 100;
                    progressFill.style.width = `${percent}%`;
                    currentTimeEl.textContent = formatTime(audio.currentTime);
                    } else {
                    // fallback using default duration from playlist
                    const song = playlist[currentSongIndex];
                    if (song && song.duration) {
                        const percent = (audio.currentTime / song.duration) * 100;
                        progressFill.style.width = `${percent}%`;
                        currentTimeEl.textContent = formatTime(audio.currentTime);
                    }
                    }
                }

                // set progress when clicking on bar
                function setProgress(e) {
                    const rect = progressBarBg.getBoundingClientRect();
                    const offsetX = e.clientX - rect.left;
                    const width = rect.width;
                    let percentage = offsetX / width;
                    percentage = Math.max(0, Math.min(1, percentage));
                    
                    const song = playlist[currentSongIndex];
                    if (song && song.duration) {
                    const newTime = song.duration * percentage;
                    audio.currentTime = newTime;
                    // update immediately
                    progressFill.style.width = `${percentage * 100}%`;
                    currentTimeEl.textContent = formatTime(newTime);
                    } else if (audio.duration && !isNaN(audio.duration)) {
                    audio.currentTime = audio.duration * percentage;
                    }
                }

                // render playlist from array
                function renderPlaylist() {
                    let html = '';
                    playlist.forEach((song, index) => {
                    html += `<li class="song-item ${index === currentSongIndex ? 'active' : ''}" data-index="${index}">
                        <i class="fas fa-heart"></i>
                        <div class="song-info-item">
                        <span class="song-name">${song.title}</span>
                        <span class="song-artist">${song.artist}</span>
                        </div>
                        <span class="love-tag"><i class="fas fa-heart"></i> ${formatTime(song.duration)}</span>
                    </li>`;
                    });
                    playlistContainer.innerHTML = html;

                    // attach click event to each song-item
                    document.querySelectorAll('.song-item').forEach(item => {
                    item.addEventListener('click', function(e) {
                        const idx = parseInt(this.dataset.index, 10);
                        if (!isNaN(idx) && idx !== currentSongIndex) {
                        currentSongIndex = idx;
                        loadSong(currentSongIndex);
                        if (isPlaying) {
                            playSong(); // play new song
                        } else {
                            // user might want to start playing? we start play.
                            playSong(); // auto-play for cuteness!
                        }
                        } else if (idx === currentSongIndex) {
                        // same song: just play if not playing
                        if (!isPlaying) playSong();
                        }
                    });
                    });
                }

                // ---------- event listeners ----------
                playPauseBtn.addEventListener('click', togglePlayPause);

                prevBtn.addEventListener('click', function() {
                    prevSong();
                });

                nextBtn.addEventListener('click', function() {
                    nextSong();
                });

                progressBarBg.addEventListener('click', setProgress);

                // audio timeupdate
                audio.addEventListener('timeupdate', updateProgress);

                // when song ends, go next
                audio.addEventListener('ended', function() {
                    nextSong();
                    // autoplay next
                    if (playlist.length > 0) {
                    // ensure playing after load
                    playSong();
                    }
                });

                // when audio metadata loaded (duration maybe)
                audio.addEventListener('loadedmetadata', function() {
                    if (audio.duration && !isNaN(audio.duration)) {
                    durationTimeEl.textContent = formatTime(audio.duration);
                    } else {
                    // fallback
                    durationTimeEl.textContent = formatTime(playlist[currentSongIndex].duration);
                    }
                });

                // initial load
                loadSong(0);
                renderPlaylist();

                // extra cute: set fake duration display (since soundhelix files may not give correct duration)
                // we already set duration from playlist in loadSong, but keep it.
                // but to keep consistent: override loadedmetadata with playlist duration
                audio.addEventListener('loadedmetadata', function() {
                    // we prefer our cute playlist duration :3
                    if (playlist[currentSongIndex]) {
                    durationTimeEl.textContent = formatTime(playlist[currentSongIndex].duration);
                    }
                });

                // if error loading audio (just for demo, keep the cuteness)
                audio.addEventListener('error', function() {
                    console.log("audio error (placeholder) ‚Äî still cute!");
                    // keep default time display
                });

                // progress bar dragging could be improved but we keep click

                // set default duration display after loadSong:
                // already set in loadSong

                // make vinyl spin only when playing; pause removes class
                // ensure class removed when pause
                window.addEventListener('load', function() {
                    // preload none? just bear
                });

                // also update current time on audio timeupdate already

                // manual trigger for timeupdate to show 0:00 properly
                // manually update progress each second via interval? timeupdate is fine.

                // also, if we want progress to show when seek
                // .............
                // also adding small hover to heart disc
                // set default duration display
                durationTimeEl.textContent = formatTime(playlist[0].duration);
                })();
            </script>

            <!-- bear icon fallback? using FA bear (solid) -->
            <!-- Font Awesome kit? not needed, using cdn -->
            <!-- fa-bear exists in FontAwesome 6? yes from v6. free solid: fa-bear -->
            <!-- If the version doesn't include bear, fallback: use fa-gift? We used fa-bear, but maybe use a cat? I'll keep as bear but provide fallback -->
            <script>
                // tiny fallback if fa-bear doesn't exist (it does in 6.0 free)
                (function() {
                let bearIcon = document.querySelector('.fa-bear');
                if (bearIcon) {
                    // all good!
                } else {
                    // replace with gift/ heart bear 
                    let avatar = document.querySelector('.bear-avatar i');
                    if (avatar) {
                    avatar.className = 'fas fa-gift'; // cute gift
                    }
                }
                })();
            </script>
        </div>
        
        <!-- Page 5: Long Distance Love Coupons -->
        <div class="page" id="page5">            
            <div class="page-title">
                <h2><i class="fas fa-ticket-alt"></i> Long Distance Love Coupons</h2>
                <p style="color: #8D6E63; font-size: 1.1rem; margin-top: 5px;">Redeem anytime, anywhere üõúüíï</p>
            </div>
            
            <div class="coupons-page">
                <!-- Decorative elements -->
                <div class="tape" style="top: 20px; left: 30px; transform: rotate(-15deg);"></div>
                <div class="tape" style="bottom: 20px; right: 30px; transform: rotate(25deg);"></div>
                
                <!-- Coupon envelope header -->
                <div class="coupon-envelope">
                    <i class="fas fa-envelope-open-text"></i>
                    <span>For my love, across the miles</span>
                </div>
                
                <!-- Coupons grid -->
                <div class="coupons-grid">
                    <!-- Coupon 1: Virtual Movie Night -->
                    <div class="coupon-card" onclick="redeemCoupon(this, 1)">
                        <div class="coupon-ribbon">LDR</div>
                        <div class="coupon-stamp"><i class="fas fa-video"></i></div>
                        <div class="coupon-icon">
                            <i class="fas fa-film"></i>
                        </div>
                        <h3>üé¨ Virtual Movie Night</h3>
                        <div class="coupon-description">
                            <p>One (1) synchronized movie night via Teleparty or Discord. I'll bring the virtual popcorn! üçø</p>
                            <p class="distance-note"><i class="fas fa-wifi"></i> Perfect for distance</p>
                        </div>
                        <div class="coupon-details">
                            <span class="coupon-expiry">Redeem within days</span>
                            <span class="coupon-code">LDR-MOVIE-01</span>
                        </div>
                        <div class="coupon-footer">
                            <span class="coupon-redeem"><i class="fas fa-heart"></i> Click to redeem</span>
                            <span class="coupon-used" style="display: none;">‚úì Redeemed!</span>
                        </div>
                        <div class="coupon-heart">‚ù§Ô∏è</div>
                    </div>
                    
                    <!-- Coupon 2: Virtual Coffee Date -->
                    <div class="coupon-card" onclick="redeemCoupon(this, 2)">
                        <div class="coupon-ribbon">LDR</div>
                        <div class="coupon-stamp"><i class="fas fa-coffee"></i></div>
                        <div class="coupon-icon">
                            <i class="fas fa-mug-hot"></i>
                        </div>
                        <h3>‚òï Virtual Coffee Date</h3>
                        <div class="coupon-description">
                            <p>One (1) 45-minute coffee date over video call. I'll make you laugh and listen to your day. ü§é</p>
                            <p class="distance-note"><i class="fas fa-phone"></i> Includes phone call option</p>
                        </div>
                        <div class="coupon-details">
                            <span class="coupon-expiry">Redeem within 2 weeks</span>
                            <span class="coupon-code">LDR-COFFEE-02</span>
                        </div>
                        <div class="coupon-footer">
                            <span class="coupon-redeem"><i class="fas fa-heart"></i> Click to redeem</span>
                            <span class="coupon-used" style="display: none;">‚úì Redeemed!</span>
                        </div>
                        <div class="coupon-heart">‚ù§Ô∏è</div>
                    </div>
                    
                    <!-- Coupon 3: Love Letter on Demand -->
                    <div class="coupon-card" onclick="redeemCoupon(this, 3)">
                        <div class="coupon-ribbon">LDR</div>
                        <div class="coupon-stamp"><i class="fas fa-envelope"></i></div>
                        <div class="coupon-icon">
                            <i class="fas fa-feather-alt"></i>
                        </div>
                        <h3>‚úâÔ∏è Love Letter On Demand</h3>
                        <div class="coupon-description">
                            <p>A handwritten-style digital love letter delivered to your phone within 24 hours. Any topic, any length. üíå</p>
                            <p class="distance-note"><i class="fas fa-mobile-alt"></i> Sent via text/email</p>
                        </div>
                        <div class="coupon-details">
                            <span class="coupon-expiry">No expiration</span>
                            <span class="coupon-code">LDR-LETTER-03</span>
                        </div>
                        <div class="coupon-footer">
                            <span class="coupon-redeem"><i class="fas fa-heart"></i> Click to redeem</span>
                            <span class="coupon-used" style="display: none;">‚úì Redeemed!</span>
                        </div>
                        <div class="coupon-heart">‚ù§Ô∏è</div>
                    </div>
                    
                    <!-- Coupon 5: "Skip the Distance" Day -->
                    <div class="coupon-card" onclick="redeemCoupon(this, 5)">
                        <div class="coupon-ribbon">LDR</div>
                        <div class="coupon-stamp"><i class="fas fa-star"></i></div>
                        <div class="coupon-icon">
                            <i class="fas fa-cloud-moon"></i>
                        </div>
                        <h3>üåô "Skip the Distance" Day</h3>
                        <div class="coupon-description">
                            <p>I'll be extra available for you all day - quick replies, surprise voice notes, and undivided attention. üí´</p>
                            <p class="distance-note"><i class="fas fa-clock"></i> 24 hours of love</p>
                        </div>
                        <div class="coupon-details">
                            <span class="coupon-expiry">Must schedule 24h in advance</span>
                            <span class="coupon-code">LDR-SKIP-05</span>
                        </div>
                        <div class="coupon-footer">
                            <span class="coupon-redeem"><i class="fas fa-heart"></i> Click to redeem</span>
                            <span class="coupon-used" style="display: none;">‚úì Redeemed!</span>
                        </div>
                        <div class="coupon-heart">‚ù§Ô∏è</div>
                    </div>
                </div>
                
                <!-- Redemption message -->
                <div id="couponMessage" class="coupon-message" style="display: none;">
                    <i class="fas fa-heart"></i> Coupon redeemed! I can't wait to fulfill this for you. üíï
                </div>
                
                <!-- Special LDR note -->
                <div class="ldr-note">
                    <i class="fas fa-map-marker-alt"></i> Distance means so little when someone means so much. 
                    <i class="fas fa-map-marker-alt"></i>
                    <p style="font-size: 0.9rem; margin-top: 8px; color: #8D6E63;">Redeem by texting me the coupon code, or just show me this page! üíå</p>
                </div>
            </div>
        </div>
        
        <!-- Page 6: Final Page -->
        <div class="page" id="page6">
            <div class="heart-sticker" style="bottom: 50px; right: 50px;"></div>
            
            <div class="page-title">
                <h2><i class="fas fa-heart"></i> Always & Forever</h2>
            </div>
            
            <div class="final-page">
                <div class="final-heart">
                    <i class="fas fa-heart"></i>
                </div>
                
                <div class="final-message">
                    Thank you for being you. Thank you for loving me. Here's to countless more Valentine's Days together.
                </div>
                
                <div style="margin-top: 40px; font-size: 2rem; color: #D32F2F; font-family: 'Dancing Script', cursive;">
                    Me & You
                </div>
            </div>
        </div>
    </div>
    
    <footer>
        <p>Made with <span style="color: #FF8A8A;"><i class="fas fa-heart"></i></span> for the most special person in my life</p>
        <p>Happy Valentine's Day, my love. Always yours.</p>
    </footer>
    
    <script>
        // Create cute chibi characters that run at the bottom of the screen
        function createChibiCharacters() {
            const container = document.getElementById('chibi-container');
            const characters = [
                { type: 'boy', right: 'Images/right.png', left: 'Images/left.png', together_left:"Images/together-left.png", 
                together_right:"Images/together-right.png",frames: 3 }, 
                { type: 'girl', right: 'Images/right-girl.png', left: 'Images/left-girl.png',together_left:"Images/together-left.png", 
                together_right: "Images/together-right.png",frames: 3 }
            ];
            
            container.innerHTML = '';
            const activeChibis = [];

            characters.forEach((config, i) => {
                const chibi = document.createElement('div');
                chibi.className = `chibi ${config.type}`;
                chibi.style.left = i === 0 ? '10%' : '80%';
                container.appendChild(chibi);
                
                activeChibis.push({
                    el: chibi,
                    config: config,
                    direction: i === 0 ? 1 : -1,
                    speed: 1.2,
                    moving: true,
                    frame: 0
                });
            });

            startAnimationLoop(activeChibis);
        }

        function startAnimationLoop(chibis) {
            const boy = chibis[0];
            const girl = chibis[1];
            let isHugging = false;

            // 1. Handle Walking Frames (Legs moving)
            setInterval(() => {
                chibis.forEach(chibi => {
                    if (chibi.moving && !isHugging) {
                        chibi.frame = (chibi.frame + 1) % 3;
                        chibi.el.style.backgroundPosition = `${chibi.frame * 50}% 0%`;
                    }
                });
            }, 150);

            // 2. Main Movement and Collision Loop
            function update() {
                if (!isHugging) {
                    chibis.forEach(chibi => {
                        if (!chibi.moving) return;

                        let pos = parseFloat(chibi.el.style.left);
                        let nextPos = pos + (chibi.direction * (chibi.speed / window.innerWidth) * 100);

                        // Set image based on direction
                        chibi.el.style.backgroundImage = `url('${chibi.direction === 1 ? chibi.config.right : chibi.config.left}')`;

                        // Wall Bounce
                        if (nextPos <= 0 || nextPos >= 92) chibi.direction *= -1;
                        
                        chibi.el.style.left = `${nextPos}%`;
                    });

                    // 3. Collision Detection
                    const boyPos = parseFloat(boy.el.style.left);
                    const girlPos = parseFloat(girl.el.style.left);
                    const distance = Math.abs(boyPos - girlPos);

                    // If they are close enough (roughly 5% screen width)
                    if (distance < 5) {
                        triggerTogether(boyPos, girlPos);
                    }
                }
                requestAnimationFrame(update);
            }

            function triggerTogether(bPos, gPos) {
                isHugging = true;
                
                // Determine image based on collision direction
                if (boy.direction === 1 && girl.direction === -1) {
                    boy.el.style.backgroundImage = "url('Images/together-right.png')";
                } else {
                    boy.el.style.backgroundImage = "url('Images/together-left.png')";
                }

                // Hide girl and expand boy to fit the double-width sprite
                girl.el.style.opacity = '0';
                boy.el.style.width = "550px"; // Wider for both characters
                boy.el.style.backgroundSize = "contain"; 
                boy.el.style.backgroundPosition = "center";

                setTimeout(() => {
                    // Reset state
                    isHugging = false;
                    girl.el.style.opacity = '1';
                    
                    // Reset boy to original single-character style
                    boy.el.style.width = "300px";
                    boy.el.style.backgroundSize = "300% auto";
                    
                    // Walk away from each other
                    boy.direction = -1;
                    girl.direction = 1;

                    // Give them a little push apart to prevent instant re-collision
                    boy.el.style.left = (parseFloat(boy.el.style.left) - 5) + "%";
                    girl.el.style.left = (parseFloat(girl.el.style.left) + 5) + "%";
                }, 2000);
            }

            update();

            // Mouse pause logic
            chibis.forEach(c => {
                c.el.addEventListener('mouseenter', () => c.moving = false);
                c.el.addEventListener('mouseleave', () => c.moving = true);
            });
        }

        document.addEventListener('DOMContentLoaded', createChibiCharacters);
        // page 5 scroiting:
        function redeemCoupon(couponElement, couponNumber) {
            // Check if already redeemed
            if (couponElement.classList.contains('redeemed')) {
                return;
            }
            
            // Add redeemed class
            couponElement.classList.add('redeemed');
            
            // Hide redeem button, show used badge
            const redeemSpan = couponElement.querySelector('.coupon-redeem');
            const usedSpan = couponElement.querySelector('.coupon-used');
            
            if (redeemSpan) redeemSpan.style.display = 'none';
            if (usedSpan) usedSpan.style.display = 'inline-block';
            
            // Show redemption message
            const messageDiv = document.getElementById('couponMessage');
            messageDiv.style.display = 'block';
            messageDiv.innerHTML = `<i class="fas fa-heart"></i> Coupon #${couponNumber} redeemed! I can't wait to fulfill this for you. üíï`;
            
            // Hide message after 5 seconds
            setTimeout(() => {
                messageDiv.style.display = 'none';
            }, 5000);
            
            // Optional: Play a little sound or add haptic feedback? 
            // For now, just log it
            console.log(`Coupon #${couponNumber} redeemed with love! üíù`);
            
            // You could also save redemption status to localStorage
            const redeemedCoupons = JSON.parse(localStorage.getItem('redeemedCoupons') || '[]');
            if (!redeemedCoupons.includes(couponNumber)) {
                redeemedCoupons.push(couponNumber);
                localStorage.setItem('redeemedCoupons', JSON.stringify(redeemedCoupons));
            }
        }

        // Add this to your DOMContentLoaded event to restore redeemed coupons
        function restoreRedeemedCoupons() {
            const redeemedCoupons = JSON.parse(localStorage.getItem('redeemedCoupons') || '[]');
            const coupons = document.querySelectorAll('.coupon-card');
            
            coupons.forEach((coupon, index) => {
                if (redeemedCoupons.includes(index + 1)) {
                    coupon.classList.add('redeemed');
                    const redeemSpan = coupon.querySelector('.coupon-redeem');
                    const usedSpan = coupon.querySelector('.coupon-used');
                    
                    if (redeemSpan) redeemSpan.style.display = 'none';
                    if (usedSpan) usedSpan.style.display = 'inline-block';
                }
            });
        }

        document.addEventListener('DOMContentLoaded', function() {
            restoreRedeemedCoupons();
        });
        // Page navigation
        const navButtons = document.querySelectorAll('.nav-btn');
        const pages = document.querySelectorAll('.page');
        const nextBtn = document.getElementById('nextBtn');
        const loveSong = document.getElementById('loveSong');
        
        // Add CSS for heart animation
        const style = document.createElement('style');
        style.textContent = `
            @keyframes heartFloatUp {
                0% { opacity: 0; transform: translateX(-50%) translateY(0) scale(0.5); }
                50% { opacity: 1; transform: translateX(-50%) translateY(-30px) scale(1.2); }
                100% { opacity: 0; transform: translateX(-50%) translateY(-60px) scale(1); }
            }
        `;
        document.head.appendChild(style);
        
        // Function to switch pages
        function switchPage(pageNumber) {
            // Hide all pages
            pages.forEach(page => {
                page.classList.remove('active');
            });
            
            // Show selected page
            const selectedPage = document.getElementById(`page${pageNumber}`);
            selectedPage.classList.add('active');
            
            // Update active button
            navButtons.forEach(button => {
                button.classList.remove('active');
                if (parseInt(button.getAttribute('data-page')) === pageNumber) {
                    button.classList.add('active');
                }
            });
            
            // If switching to song page (page 4), play the song
            if (pageNumber === 4) {
                // Auto-play song when page loads
                setTimeout(() => {
                    loveSong.play().catch(e => {
                        console.log("Auto-play was prevented. User interaction required.");
                    });
                }, 500);
            } else {
                // Pause song when leaving song page
                loveSong.pause();
            }
            
            // Scroll to top of page
            window.scrollTo(0, 0);
        }
        
        // Add click event to navigation buttons
        navButtons.forEach(button => {
            button.addEventListener('click', function() {
                const pageNumber = parseInt(this.getAttribute('data-page'));
                switchPage(pageNumber);
            });
        });
        
        // Next button on cover page
        nextBtn.addEventListener('click', function() {
            switchPage(2);
        });
        
        // Music player controls
        const playBtn = document.getElementById('playBtn');
        const pauseBtn = document.getElementById('pauseBtn');
        const stopBtn = document.getElementById('stopBtn');
        
        playBtn.addEventListener('click', function() {
            loveSong.play();
        });
        
        pauseBtn.addEventListener('click', function() {
            loveSong.pause();
        });
        
        stopBtn.addEventListener('click', function() {
            loveSong.pause();
            loveSong.currentTime = 0;
        });

        // Add touch event listeners for better mobile interaction
        document.addEventListener('DOMContentLoaded', function() {
            // Prevent zoom on double-tap
            let lastTouchEnd = 0;
            document.addEventListener('touchend', function(event) {
                const now = (new Date()).getTime();
                if (now - lastTouchEnd <= 300) {
                    event.preventDefault();
                }
                lastTouchEnd = now;
            }, false);
            
            // Improve button feedback on touch devices
            const buttons = document.querySelectorAll('button');
            buttons.forEach(button => {
                button.addEventListener('touchstart', function() {
                    this.style.transform = 'scale(0.95)';
                });
                
                button.addEventListener('touchend', function() {
                    this.style.transform = 'scale(1)';
                });
            });
            
            // Adjust chibi animation for mobile performance
            if (window.innerWidth <= 768) {
                const chibis = document.querySelectorAll('.chibi');
                chibis.forEach(chibi => {
                    chibi.style.transition = 'transform 0.2s';
                });
            }
        });
        
        // Initialize the page
        document.addEventListener('DOMContentLoaded', function() {
            createChibiCharacters();
            switchPage(1); // Start on page 1
            
            // Add heart stickers to random media items
            const mediaItems = document.querySelectorAll('.media-item');
            mediaItems.forEach((item, index) => {
                if (index % 2 === 0) {
                    const heart = document.createElement('div');
                    heart.className = 'heart-sticker';
                    heart.style.top = '-15px';
                    heart.style.right = '-15px';
                    heart.style.width = '30px';
                    heart.style.height = '30px';
                    heart.style.zIndex = '5';
                    item.style.position = 'relative';
                    item.appendChild(heart);
                }
            });
            
            // Add floating hearts on click anywhere
            document.addEventListener('click', function(e) {
                // Don't create hearts if clicking on interactive elements
                if (e.target.closest('button') || e.target.closest('video') || e.target.closest('audio') || e.target.closest('.chibi')) {
                    return;
                }
                
                // Create heart at click position
                const heart = document.createElement('div');
                heart.innerHTML = '<i class="fas fa-heart"></i>';
                heart.style.position = 'fixed';
                heart.style.color = '#D32F2F';
                heart.style.fontSize = '24px';
                heart.style.left = `${e.clientX}px`;
                heart.style.top = `${e.clientY}px`;
                heart.style.zIndex = '1000';
                heart.style.pointerEvents = 'none';
                heart.style.transform = 'translate(-50%, -50%)';
                heart.style.animation = 'heartFloatUp 1.5s ease-out forwards';
                
                document.body.appendChild(heart);
                
                // Remove heart after animation
                setTimeout(() => {
                    if (heart.parentNode) {
                        heart.parentNode.removeChild(heart);
                    }
                }, 1500);
            });
        });
    </script>
</body>
</html>